name: playground

on:
  push:
    paths:
      - playground/**
      - .github/workflows/playground.yml

jobs:
  html5:
    runs-on: ubuntu-latest
    env:
      project: playground
    steps:
      - uses: actions/checkout@v2
      - name: Build
        uses: tong/armory_gh_actions@v0.0.32
        with:
          blend: ${{ env.project }}/${{ env.project }}.blend
          exporter: html5
      - name: Check export result
        run: |
          tree ${{ env.project }}
          test -f ${{ env.project }}/khafile.js
          test -f ${{ env.project }}/Sources/Main.hx
          test -f ${{ env.project }}/build_${{ env.project }}/html5/kha.js
      - name: Store artifact
        uses: actions/upload-artifact@v2
        with:
          name: armory_tutotorial-${{ env.project }}-html5
          path: ${{ env.project }}/build_${{ env.project }}/html5
      - name: Deploy gh-pages
        uses: JamesIves/github-pages-deploy-action@4.1.4
        with:
          branch: gh-pages
          folder: ${{ env.project }}/build_${{ env.project }}/html5
          target-folder: ${{ env.project }}
  krom-linux:
    runs-on: ubuntu-latest
    env:
      project: playground
    steps:
      - uses: actions/checkout@v2
      - name: Build
        uses: tong/armory_gh_actions@v0.0.32
        with:
          blend: ${{ env.project }}/${{ env.project }}.blend
          exporter: krom-linux
      - name: Check export result
        run: |
          tree ${{ env.project }}
          test -f ${{ env.project }}/khafile.js
          test -f ${{ env.project }}/Sources/Main.hx
      - name: Store artifact
        uses: actions/upload-artifact@v2
        with:
          name: armory_tutorial-${{ env.project }}-krom-linux
          path: ${{ env.project }}/build_${{ env.project }}/krom-linux
  linux-hl:
    runs-on: ubuntu-latest
    env:
      project: playground
    steps:
      - uses: actions/checkout@v2
      - name: Build
        uses: tong/armory_gh_actions@v0.0.32
        with:
          blend: ${{ env.project }}/${{ env.project }}.blend
          exporter: linux-hl
      - name: Store artifact
        uses: actions/upload-artifact@v2
        with:
          name: armory_tutorial-${{ env.project }}-linux
          path: ${{ env.project }}/build_${{ env.project }}/linux-hl
  android-hl:
    runs-on: ubuntu-latest
    env:
      project: playground
    steps:
      - uses: actions/checkout@v2
      - name: Build
        uses: tong/armory_gh_actions@v0.0.32
        with:
          blend: ${{ env.project }}/${{ env.project }}.blend
          exporter: android-hl
      - name: Store artifact
        uses: actions/upload-artifact@v2
        with:
          name: armory_tutorial-${{ env.project }}-android
          path: ${{ env.project }}/build_${{ env.project }}/android-hl
  windows-hl:
    runs-on: ubuntu-latest
    env:
      project: playground
    steps:
      - uses: actions/checkout@v2
      - name: Build
        uses: tong/armory_gh_actions@v0.0.32
        with:
          blend: ${{ env.project }}/${{ env.project }}.blend
          exporter: windows-hl
      - name: Store artifact
        uses: actions/upload-artifact@v2
        with:
          name: armory_tutorial-${{ env.project }}-windows
          path: ${{ env.project }}/build_${{ env.project }}/windows-hl
  macos-hl:
    runs-on: ubuntu-latest
    env:
      project: playground
    steps:
      - uses: actions/checkout@v2
      - name: Build
        uses: tong/armory_gh_actions@v0.0.32
        with:
          blend: ${{ env.project }}/${{ env.project }}.blend
          exporter: macos-hl
      - name: Store artifact
        uses: actions/upload-artifact@v2
        with:
          name: armory_tutorial-${{ env.project }}-macos
          path: ${{ env.project }}/build_${{ env.project }}/macos-hl
  ios-hl:
    runs-on: ubuntu-latest
    env:
      project: playground
    steps:
      - uses: actions/checkout@v2
      - name: Build
        uses: tong/armory_gh_actions@v0.0.32
        with:
          blend: ${{ env.project }}/${{ env.project }}.blend
          exporter: ios-hl
      - name: Store artifact
        uses: actions/upload-artifact@v2
        with:
          name: armory_tutorial-${{ env.project }}-ios
          path: ${{ env.project }}/build_${{ env.project }}/ios-hl
